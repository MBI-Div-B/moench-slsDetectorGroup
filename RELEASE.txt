SLS Detector Package 6.0.0 released on xx.10.2021 (Major Release)
===================================================================

This document describes the differences between 6.0.0 and 5.2.0 releases.   



    CONTENTS
    --------
    1.  New or Changed Features
    2.  Resolved Issues
    3.  Known Issues
    4.  Firmware Requirements
    5.  Download, Documentation & Support




1. New or Changed Features
==========================

    Jungfrau
    --------

    1.  Features for chipv1.1 incorporated

    2.  Chip version
        Command line: chipversion, API: getchipVersion 
        gets chip version (1.0 or 1.1)
        chipv1.1 requires config_jungfrau.txt on detector server.
    
    3.  Chip configuration (only chipv1.1)
        powering on the chip and changing settings will configure the chip.
        Hence, required before acquisition.

    4.  Settings and Gain mode
        Settings can be gain0 and highgain0. Gain mode can be dynamicgain, 
        forceswitchg1, forceswitchg2, fixg1, fixg2, fixg0. fixg0 must be 
        used with EXTRA caution as you can damage the detector.
        Changing settings also changes dac values of 3 dacs () and reconfigures
        chip (only v1.1)

    5.  Storage cells (only chipv1.1)
        Additional number of storage cells not applicable for chipv1.1.
        Storage cell start is only allowed from 0 - 3 for chipv1.1 
        (0 - 15 for chipv1.0).
    
    6.  Filter cell (only chipv1.1)
        Command line: filtercell, API: getFilterCell/ setFilterCell
        Set filter cell. Options: [0-12]. Advanced user command.

    7.  Comparator disable time (only chipv1.1)
        Command line: comp_disable_time, API: getComparatorDisableTime/ 
        setComparatorDisableTime 
        One can customize the period to disable comparator.

    Others
    ------

    1.  Flip rows [Eiger][Jungfrau]
        Command line: fliprows, API: getFlipRows/ setFlipRows
        Previous command: flippeddatax, setBottom/ getBottom
        [Jungfrau] Flips rows in detector only for HW v2.0.
        slsReceiver and slsDetectorGui will not flip them again.
        [Eiger] same as before.

    2.  Read n rows [Eiger][Jungfrau]
        Command line: readnrows, API: getReadNRows/ setReadNRows
        Previous Command: readnlines, getPartialReadout/ setPartialReadout
        [Eiger] same as before
        [Jungfrau] Options: 8 - 512, multiples of 8. Default is 512.

    2.  Filter Resistor [Gotthard2][Jungfrau]
        Command line: filterresistor, API: getFilterResistor/ setFilterResistor
        Previous Command: filter, setFilter/ getFilter
        Set Filter resistor. Increasing values for increasing resistance.
        [Jungfrau] only for chipv1.1. Options: [0|1]. Default is 1.
        [Gotthard2] Options: [0|1|2|3]. Default is 0.

    3.  Current source [Gotthard2][Jungfrau]
        Command line: currentsource, API: getCurrentSource, setCurrentSource
        Enable or disable current source. Default is disabled.
        [Gotthard2] Can only enable or disable.
        [Jungfrau] Can choose to fix, select source and choose normal or low 
        current. Normal/ low only for chipv1.1. 
        Select source is 0-63 for chipv1.0 and a 64 bit mask for chipv1.1. 

    2.  Default dac 
        Command line: defaultdac, API: getDefaultDac/ setDefaultDac
        change default value of a dac
        [Jungfrau][Mythen3] Also change default value of dac for particular 
        setting.

    3.  Reset dacs
        Command line: resetdacs, API: resetToDefaultDacs
        Previous command: defaultdacs
        Resets dacs to their default values or hard coded values.

        



    Client
    ------
    1. Setting Mythen3 gain from command line


    2.  (Gotthard2) veto streaming
        New command to enable/ disable veto streaming via 2.5GbE or/ and 10GbE 
        (debugging). 
        Command: vetostream, Detector::setVetoStream
        

    2.  (Gotthard2) veto algorithm
        New command to set veto algorithm for 2.5GbE or 10GbE (debugging). 
        Command: vetoalg, Detector::setVetoAlgorithm

    Gotthard2 server
    ----------------

    1.  Bad Channels moved to a new register
    

    Jungfrau- many Features

    

2. Resolved Issues
==================

    Jungfrau
    --------

    1.  

    Gotthard2 Server
    ----------------

    1.  Tolerance in time parameters. 
        Eg. 220 ns was being set to 215 ns, instead of 222ns.



    Jungfrau Server
    ----------------

    1.  Stopping in trigger mode and then switching to auto timing mode 
        blocks data streaming from detector. Workaround fix made in 
        detector server to reset core until firmware release.


getAutoCompDisable->getAutoComparatorDisable
filter->filterResistor
setBottom->setFlipRows
currentsource expects currentsrcparameters structure instread of bool

g2: 
updated config file indetector server
vetoalg
vetostream
serialnumber (put)
dbitpipeline
readnlines->readnrows
serialnumber->moduleid

setting number of udp interfaces from 1 to 2, didnt get image in gui 

virtual server plots increasing values for every packet.. not every pixel

3. Firmware Requirements
========================
        
    Eiger
    =====  
    Compatible version : 08.09.2020 (v27)
    
    Jungfrau
    ========       
    Compatible version : 31.08.2021 (v1.2, PCB v1.0) 
                       : 10.09.2021 (v2.2, PCB v2.0)

    Gotthard
    ========   
    Compatible version : 08.02.2018 (50um and 25um Master)
                       : 09.02.2018 (25 um Slave) 

    Mythen3
    =======
    Compatible version : 10.09.2021 (development)

    Gotthard2
    =========
    Compatible version : 27.05.2021 (development)

    Moench
    ======
    Compatible version : 05.10.2020 (v1.0)

    Ctb
    ===
    Compatible version : 05.10.2020 (v1.0)

    Detector Upgrade
    ================

    The following can be upgraded remotely:
    Eiger      via bit files
    Jungfrau   via command <.pof>
    Mythen3    via command <.rbf>
    Gotthard2  via command <.rbf> 
    Moench     via command <.pof>
    Ctb        via command <.pof>

    The following cannot be upgraded remotely:
    Gotthard   

    Instructions available at
        https://slsdetectorgroup.github.io/devdoc/firmware.html
    and
        https://slsdetectorgroup.github.io/devdoc/serverupgrade.html




5. Known Issues
===============

    Receiver
    --------
    1.  It does not handle readnrows or partial readout. Only the summary
        is adjusted to print in red. However, it will still write complete
        images with missing data padded. Roi will be implemented in future
        that can be complimented with this feature to remove the additional
        data in files.

    2.  Round robin is not implemented in receiver side, ie. one cannot configure
        more than 1 receiver at a time. This will/might be done in the future.



6. Download, Documentation & Support
====================================

    Download
    --------
    
    The Source Code:
         https://github.com/slsdetectorgroup/slsDetectorPackage
            
    Documentation
    -------------
    
    Installation:
        https://slsdetectorgroup.github.io/devdoc/installation.html#
        
    Firmware Upgrade:
        https://slsdetectorgroup.github.io/devdoc/firmware.html

    Detector Server upgrade:
        https://slsdetectorgroup.github.io/devdoc/serverupgrade.html

    Detector Simulators:
        https://slsdetectorgroup.github.io/devdoc/virtualserver.html

    Consuming slsDetectorPackage:
        https://slsdetectorgroup.github.io/devdoc/consuming.html
        
    API Examples:
        https://github.com/slsdetectorgroup/api-examples

    Command Line Documentation:
        https://slsdetectorgroup.github.io/devdoc/commandline.html

    Quick Start Guide:
        https://slsdetectorgroup.github.io/devdoc/quick_start_guide.html
        
    C++ API Documentation:
        https://slsdetectorgroup.github.io/devdoc/detector.html
       
    C++ API Example:
        https://slsdetectorgroup.github.io/devdoc/examples.html#
        
    Python API Documentation:
        https://slsdetectorgroup.github.io/devdoc/pygettingstarted.html

    Python API Example:
        https://slsdetectorgroup.github.io/devdoc/pyexamples.html

    Receivers (including custom receiver):
        https://slsdetectorgroup.github.io/devdoc/receivers.html
        https://slsdetectorgroup.github.io/devdoc/slsreceiver.html

    TroubleShooting:
        https://slsdetectorgroup.github.io/devdoc/troubleshooting.html
        
    Further Documentation:
        https://www.psi.ch/en/detectors/documentation
        
    Info on Releases:
        https://www.psi.ch/en/detectors/software


    Support
    -------

        dhanya.thattil@psi.ch
        erik.frojdh@psi.ch

